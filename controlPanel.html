<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CFM Workbook | Admin Control</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="locked">
    <div id="access-lock-screen">
        <div class="lock-box">
            <h2 class="lock-title">üîí Admin Access</h2>
            <input type="password" id="access-password-input" placeholder="Enter admin code..." autofocus>
            <button onclick="checkAccessPassword()">Unlock Panel</button>
            <p id="lock-error-message"></p>
        </div>
    </div>
    
    <div id="main-content-wrapper">
        <header>
            <div class="header-content">
                <div class="logo-container">
                    <img src="logo.png" alt="Logo" class="logo">
                    <h1 class="site-title">Admin <b>Control Panel</b></h1>
                </div>
                <div id="trenton-clock">00:00:00</div>
                <nav class="dropdown-nav">
                    <button class="menu-button" onclick="toggleMenu()">Menu ‚ò∞</button>
                    <div id="dropdown-content" class="dropdown-content">
                        <a href="index.html">Home</a>
                        <a href="training.html">Training Center</a>
                        <a href="selfPayPrices.html">Self-Pay</a>
                        <a href="visitTypes.html">Visit Types</a>
                        <a href="controlPanel.html" class="active">Admin Control</a>
                    </div>
                </nav>
            </div>
        </header>

        <main class="container">
            <section class="info-card">
                <h2>üõ†Ô∏è Training Management</h2>
                <p>Use these tools to manage training sessions on this specific workstation.</p>
                <hr style="margin: 15px 0; border: 0; border-top: 1px solid #e2e8f0;">
                
                <div id="training-status-area">
                    <h4>Current Workstation Status:</h4>
                    <p id="local-status-text">Checking for data...</p>
                    
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="menu-button" onclick="checkLocalTraining()">Refresh Status</button>
                        <button class="menu-button" style="background-color: #dc2626 !important;" onclick="resetLocalTraining()">Reset Training for New User</button>
                    </div>
                </div>
            </section>

            <section class="info-card">
                <h3>Update Instructions</h3>
                <p>To update pricing or provider lists, you must edit the individual HTML files. After saving, ensure you clear the browser cache on clinical workstations to see changes.</p>
                <ul>
                    <li><b>Pricing:</b> Edit <code>selfPayPrices.html</code></li>
                    <li><b>Training Content:</b> Edit <code>training.html</code></li>
                    <li><b>Global Styles:</b> Edit <code>style.css</code></li>
                </ul>
            </section>
        </main>

        <footer>
            <p>&copy; 2026 CFM Internal Systems</p>
        </footer>
    </div>
    
    <script src="script.js"></script>
    <script src="lock.js"></script>
    <script>
        // Function to check what is saved in the browser
        function checkLocalTraining() {
            const data = localStorage.getItem('cfm_training_progress');
            const statusText = document.getElementById('local-status-text');
            
            if (data) {
                const progress = JSON.parse(data);
                const steps = progress.length;
                if (steps >= 4) {
                    statusText.innerHTML = `<b style="color: #166534;">‚úÖ Training Complete (${steps}/4 steps)</b>`;
                } else {
                    statusText.innerHTML = `<b style="color: #ca8a04;">‚ö†Ô∏è Training In-Progress (${steps}/4 steps)</b>`;
                }
            } else {
                statusText.innerHTML = "<b>‚ö™ No Training Data Found.</b> System is ready for a new user.";
            }
        }

        // Function to wipe the training data
        function resetLocalTraining() {
            if (confirm("Are you sure? This will delete the progress for the current user and they will have to start the training from Step 1.")) {
                localStorage.removeItem('cfm_training_progress');
                alert("Training data has been cleared.");
                checkLocalTraining();
            }
        }

        // Run check on load
        document.addEventListener('DOMContentLoaded', checkLocalTraining);
    </script>
</body>
</html>
